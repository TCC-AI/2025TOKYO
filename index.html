<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±äº¬äº”æ—¥éŠè¡Œç¨‹è¦åŠƒ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* ==================== CSS æ¨£å¼ ==================== */
        
        /* åŸºæœ¬æ¨£å¼è¨­å®š */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, 
    #1e3c72 0%,     /* æ·±æ±äº¬è— */
    #2a5298 25%,    /* æ±äº¬å¤œç©ºè— */
    #4a90e2 50%,    /* æ±äº¬ç£è— */
    #1e88e5 75%,    /* æ™´ç©ºå¡”è— */
    #0d47a1 100%    /* æ·±æµ·è— */
);

            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* é ­éƒ¨æ¨£å¼ */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* å°èˆªé¸å–® */
        .nav-menu {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover, .nav-btn.active {
            background: rgba(255,255,255,0.9);
            color: #333;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* ä¸»è¦å…§å®¹å€ */
        .main-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ—¥æœŸé¸æ“‡å™¨ */
        .day-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .day-btn {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .day-btn:hover, .day-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
            transform: scale(1.05);
        }

        /* æ¯æ—¥è¡Œç¨‹å…§å®¹ */
        .day-content {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }

        /* æ–°å¢ï¼šæ¯æ—¥å‹•ç·šé€£çµæ¨£å¼ */
        .day-route-link {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            transition: transform 0.3s ease;
        }

        .day-route-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .day-route-link a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .day-route-link i {
            margin-right: 8px;
        }

        .itinerary-item {
            background: white;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #007bff;
            transition: transform 0.2s ease;
        }

        .itinerary-item:hover {
            transform: translateX(5px);
        }

        .itinerary-item h3 {
            color: #007bff;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .itinerary-item .time {
            background: #e3f2fd;
            color: #1976d2;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* æ–°å¢ï¼šGoogleåœ°åœ–é€£çµæ¨£å¼ */
        .map-link {
            background: #e8f5e8;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 3px solid #4CAF50;
        }

        .map-link a {
            color: #2e7d32;
            text-decoration: none;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .map-link a:hover {
            color: #1b5e20;
            text-decoration: underline;
        }

        .transport-info {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 3px solid #ffc107;
        }

        .transport-info h4 {
            color: #856404;
            margin-bottom: 8px;
        }

        .food-info {
            background: #d1ecf1;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 3px solid #17a2b8;
        }

        .food-info strong {
            color: #0c5460;
        }

        /* æ™¯é»äº®é»æ¨£å¼ */
        .highlight-info {
            background: #d4edda;
            padding: 12px 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 3px solid #28a745;
        }

        .highlight-info strong {
            color: #155724;
        }

        /* äº¤é€šæŒ‡å—æ¨£å¼ */
        .transport-section {
            margin-bottom: 40px;
        }

        .ticket-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .ticket-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .ticket-card:hover {
            transform: translateY(-5px);
        }

        .ticket-card h3 {
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .ticket-card .price {
            font-size: 2rem;
            font-weight: bold;
            margin: 15px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* è·¯ç·šè¦åŠƒå™¨ */
        .route-planner {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
        }

        .route-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .route-form input {
            flex: 1;
            min-width: 200px;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
        }

        .btn-primary {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,123,255,0.3);
        }

        .route-result {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #dee2e6;
        }

        /* é ç®—è¨ˆç®—å™¨ */
        .budget-calculator h2 {
            margin-bottom: 25px;
            color: #495057;
        }

        .budget-form .budget-item {
            margin-bottom: 20px;
        }

        .budget-form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #495057;
        }

        .budget-form input[type="number"] {
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            width: 100px;
        }

        .budget-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .category {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #dee2e6;
        }

        .category h3 {
            color: #495057;
            margin-bottom: 15px;
            text-align: center;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .expense-input {
            width: 100px;
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            text-align: right;
        }

        .budget-summary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .total-budget h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        #total-amount, #per-person-amount {
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* å¾…è¾¦æ¸…å–® */
        .checklist-section h2 {
            margin-bottom: 25px;
            color: #495057;
        }

        .checklist-category {
            margin-bottom: 30px;
        }

        .checklist-category h3 {
            color: #495057;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f3f4;
            transition: all 0.3s ease;
        }

        .checklist-item:hover {
            background: #f8f9fa;
            padding-left: 10px;
        }

        .checklist-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            cursor: pointer;
        }

        .checklist-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .checklist-item .delete-btn {
            margin-left: auto;
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .checklist-item:hover .delete-btn {
            opacity: 1;
        }

        .add-item-form {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .add-item-form input, .add-item-form select {
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
        }

        .add-item-form input {
            flex: 1;
            min-width: 250px;
        }

        /* æ—…éŠç­†è¨˜ */
        .notes-section h2 {
            margin-bottom: 25px;
            color: #495057;
        }

        .note-form {
            margin-bottom: 30px;
        }

        .note-form input, .note-form textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 15px;
            font-family: inherit;
        }

        .note-form textarea {
            min-height: 120px;
            resize: vertical;
        }

        .note-item {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .note-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .note-item h4 {
            color: #495057;
            margin-bottom: 10px;
        }

        .note-item .note-date {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .note-item .note-content {
            line-height: 1.6;
        }

        .note-item .note-actions {
            margin-top: 15px;
            text-align: right;
        }

        .note-item .delete-note-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        /* æµ®å‹•æ“ä½œæŒ‰éˆ• */
        .floating-actions {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 1000;
        }

        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .fab:hover {
            background: #0056b3;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,123,255,0.4);
        }

        /* è¼‰å…¥å‹•ç•« */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading.hidden {
            display: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* æˆåŠŸ/éŒ¯èª¤è¨Šæ¯ */
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
            animation: slideIn 0.5s ease;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .nav-menu {
                gap: 5px;
            }
            
            .nav-btn {
                padding: 10px 15px;
                font-size: 0.8rem;
            }
            
            .route-form {
                flex-direction: column;
            }
            
            .route-form input {
                min-width: auto;
            }
            
            .floating-actions {
                bottom: 20px;
                right: 20px;
            }
            
            .budget-categories {
                grid-template-columns: 1fr;
            }
            
            .ticket-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .day-selector {
                gap: 5px;
            }
            
            .day-btn {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            .add-item-form {
                flex-direction: column;
            }
            
            .add-item-form input {
                min-width: auto;
            }
        }

        /* éš±è—é¡åˆ¥ */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é ­éƒ¨å°èˆª -->
        <header class="header">
            <h1><i class="fas fa-torii-gate"></i> æ±äº¬äº”æ—¥éŠè¡Œç¨‹ã€2.0ç‰ˆã€‘</h1>
            <p>2025/07/20-24 å®Œæ•´æ”»ç•¥</p>
        </header>

        <!-- åŠŸèƒ½é¸å–® -->
        <nav class="nav-menu">
            <button class="nav-btn active" data-tab="itinerary">
                <i class="fas fa-calendar-alt"></i> è¡Œç¨‹ç¸½è¦½
            </button>
            <button class="nav-btn" data-tab="transport">
                <i class="fas fa-train"></i> äº¤é€šæŒ‡å—
            </button>
            <button class="nav-btn" data-tab="budget">
                <i class="fas fa-yen-sign"></i> é ç®—è¨ˆç®—
            </button>
            <button class="nav-btn" data-tab="checklist">
                <i class="fas fa-check-square"></i> å¾…è¾¦æ¸…å–®
            </button>
            <button class="nav-btn" data-tab="notes">
                <i class="fas fa-sticky-note"></i> æ—…éŠç­†è¨˜
            </button>
        </nav>

        <!-- ä¸»è¦å…§å®¹å€ -->
        <main class="main-content">
            <!-- è¡Œç¨‹ç¸½è¦½é é¢ -->
            <div id="itinerary" class="tab-content active">
                <div class="day-selector">
                    <button class="day-btn active" data-day="1">Day 1</button>
                    <button class="day-btn" data-day="2">Day 2</button>
                    <button class="day-btn" data-day="3">Day 3</button>
                    <button class="day-btn" data-day="4">Day 4</button>
                    <button class="day-btn" data-day="5">Day 5</button>
                </div>
                
                <div id="day-content" class="day-content">
                    <!-- å‹•æ…‹è¼‰å…¥æ¯æ—¥è¡Œç¨‹ -->
                </div>
            </div>

            <!-- äº¤é€šæŒ‡å—é é¢ -->
            <div id="transport" class="tab-content">
                <div class="transport-section">
                    <h2><i class="fas fa-route"></i> äº¤é€šç¥¨åˆ¸å»ºè­°</h2>
                    <div class="ticket-cards">
                        <div class="ticket-card">
                            <h3>JR Narita Express ä¾†å›åˆ¸</h3>
                            <p class="price">Â¥4,070</p>
                            <p>æˆç”°æ©Ÿå ´ â†” æ–°å®¿ç«™<br>ç´„80åˆ†é˜è»Šç¨‹</p>
                        </div>
                        <div class="ticket-card">
                            <h3>Welcome Suica</h3>
                            <p class="price">Â¥2,000</p>
                            <p>å«Â¥1,500å„²å€¼ï¼Œ28å¤©æœ‰æ•ˆ<br>å¯æ­æ‰€æœ‰äº¤é€šå·¥å…·</p>
                        </div>
                        <div class="ticket-card">
                            <h3>è¿ªå£«å°¼åº¦å‡å€ç·š</h3>
                            <p class="price">Â¥660</p>
                            <p>èˆæ¿±ç«™ â†” è¿ªå£«å°¼æ¨‚åœ’<br>ä¸€æ—¥ç„¡é™æ­ä¹˜</p>
                        </div>
                    </div>
                </div>
                
                <div class="route-planner">
                    <h2><i class="fas fa-map-marked-alt"></i> è·¯ç·šè¦åŠƒå™¨</h2>
                    <div class="route-form">
                        <input type="text" id="from-station" placeholder="å‡ºç™¼ç«™ (ä¾‹: æ–°å®¿)">
                        <input type="text" id="to-station" placeholder="ç›®çš„åœ° (ä¾‹: æ·ºè‰)">
                        <button id="search-route" class="btn-primary">
                            <i class="fas fa-search"></i> æŸ¥è©¢è·¯ç·š
                        </button>
                    </div>
                    <div id="route-result" class="route-result hidden">
                        <!-- è·¯ç·šçµæœé¡¯ç¤ºå€ -->
                    </div>
                </div>
            </div>

            <!-- é ç®—è¨ˆç®—é é¢ -->
            <div id="budget" class="tab-content">
                <div class="budget-calculator">
                    <h2><i class="fas fa-calculator"></i> é ç®—è¨ˆç®—å™¨</h2>
                    <div class="budget-form">
                        <div class="budget-item">
                            <label>æ—…éŠäººæ•¸</label>
                            <input type="number" id="people-count" value="1" min="1" max="10">
                        </div>
                        <div class="budget-categories">
                            <div class="category">
                                <h3><i class="fas fa-plane"></i> äº¤é€šè²»ç”¨</h3>
                                <div class="expense-item">
                                    <span>æ©Ÿç¥¨</span>
                                    <input type="number" class="expense-input" data-category="transport" value="15000">
                                </div>
                                <div class="expense-item">
                                    <span>ç•¶åœ°äº¤é€š</span>
                                    <input type="number" class="expense-input" data-category="transport" value="6000">
                                </div>
                            </div>
                            <div class="category">
                                <h3><i class="fas fa-bed"></i> ä½å®¿è²»ç”¨</h3>
                                <div class="expense-item">
                                    <span>é£¯åº— (5æ™š)</span>
                                    <input type="number" class="expense-input" data-category="accommodation" value="25000">
                                </div>
                            </div>
                            <div class="category">
                                <h3><i class="fas fa-utensils"></i> é¤é£²è²»ç”¨</h3>
                                <div class="expense-item">
                                    <span>é¤è²» (5å¤©)</span>
                                    <input type="number" class="expense-input" data-category="food" value="15000">
                                </div>
                            </div>
                            <div class="category">
                                <h3><i class="fas fa-ticket-alt"></i> é–€ç¥¨è²»ç”¨</h3>
                                <div class="expense-item">
                                    <span>è¿ªå£«å°¼</span>
                                    <input type="number" class="expense-input" data-category="tickets" value="10900">
                                </div>
                                <div class="expense-item">
                                    <span>å…¶ä»–æ™¯é»</span>
                                    <input type="number" class="expense-input" data-category="tickets" value="5200">
                                </div>
                            </div>
                            <div class="category">
                                <h3><i class="fas fa-shopping-bag"></i> è³¼ç‰©é ç®—</h3>
                                <div class="expense-item">
                                    <span>è³¼ç‰©</span>
                                    <input type="number" class="expense-input" data-category="shopping" value="30000">
                                </div>
                            </div>
                        </div>
                        <div class="budget-summary">
                            <div class="total-budget">
                                <h3>ç¸½é ç®—ï¼š<span id="total-amount">Â¥107,100</span></h3>
                                <p>æ¯äººå¹³å‡ï¼š<span id="per-person-amount">Â¥107,100</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å¾…è¾¦æ¸…å–®é é¢ -->
            <div id="checklist" class="tab-content">
                <div class="checklist-section">
                    <h2><i class="fas fa-tasks"></i> å‡ºç™¼å‰æº–å‚™</h2>
                    <div class="checklist-category">
                        <h3><i class="fas fa-globe"></i> ç·šä¸Šé ç´„ (å‡ºç™¼å‰60å¤©)</h3>
                        <div class="checklist-items" id="online-booking">
                            <!-- å‹•æ…‹è¼‰å…¥å¾…è¾¦äº‹é … -->
                        </div>
                    </div>
                    <div class="checklist-category">
                        <h3><i class="fas fa-suitcase"></i> è¡Œææº–å‚™</h3>
                        <div class="checklist-items" id="packing-list">
                            <!-- å‹•æ…‹è¼‰å…¥å¾…è¾¦äº‹é … -->
                        </div>
                    </div>
                    <div class="checklist-category">
                        <h3><i class="fas fa-passport"></i> è­‰ä»¶æ–‡ä»¶</h3>
                                                <div class="checklist-items" id="documents">
                            <!-- å‹•æ…‹è¼‰å…¥å¾…è¾¦äº‹é … -->
                        </div>
                    </div>
                    <div class="add-item-form">
                        <input type="text" id="new-item" placeholder="æ–°å¢å¾…è¾¦äº‹é …...">
                        <select id="item-category">
                            <option value="online-booking">ç·šä¸Šé ç´„</option>
                            <option value="packing-list">è¡Œææº–å‚™</option>
                            <option value="documents">è­‰ä»¶æ–‡ä»¶</option>
                        </select>
                        <button id="add-item" class="btn-primary">
                            <i class="fas fa-plus"></i> æ–°å¢
                        </button>
                    </div>
                </div>
            </div>

            <!-- æ—…éŠç­†è¨˜é é¢ -->
            <div id="notes" class="tab-content">
                <div class="notes-section">
                    <h2><i class="fas fa-pen"></i> æ—…éŠç­†è¨˜</h2>
                    <div class="note-form">
                        <input type="text" id="note-title" placeholder="ç­†è¨˜æ¨™é¡Œ">
                        <textarea id="note-content" placeholder="è¨˜éŒ„ä½ çš„æ—…éŠå¿ƒå¾—ã€é‡è¦æé†’æˆ–è‡¨æ™‚è®Šæ›´..."></textarea>
                        <button id="save-note" class="btn-primary">
                            <i class="fas fa-save"></i> å„²å­˜ç­†è¨˜
                        </button>
                    </div>
                    <div id="notes-list" class="notes-list">
                        <!-- å‹•æ…‹è¼‰å…¥ç­†è¨˜åˆ—è¡¨ -->
                    </div>
                </div>
            </div>
        </main>

        <!-- æµ®å‹•æ“ä½œæŒ‰éˆ• -->
        <div class="floating-actions">
            <button id="share-btn" class="fab" title="åˆ†äº«è¡Œç¨‹">
                <i class="fas fa-share-alt"></i>
            </button>
            <button id="offline-btn" class="fab" title="é›¢ç·šä¸‹è¼‰">
                <i class="fas fa-download"></i>
            </button>
        </div>

        <!-- è¼‰å…¥ä¸­å‹•ç•« -->
        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <p>è¼‰å…¥ä¸­...</p>
        </div>
    </div>

    <script>
        // ==================== JavaScript ä»£ç¢¼ ==================== 
        
        // å…¨åŸŸè®Šæ•¸
        const API_BASE_URL = 'https://script.google.com/macros/s/AKfycbzjB7WMI9c_Tb1FLX2E3rhgAFhySdS-63dUFdHjKCIhc0LtYtLI9x2WbPpGtpmtkeb5/exec';
        let currentDay = 1;
        let budgetData = {};
        let checklistData = {};
        let notesData = [];

        // ä¿®æ”¹å¾Œçš„è¡Œç¨‹è³‡æ–™ (åŠ å…¥ç§‹è‘‰åŸå’ŒGoogleåœ°åœ–é€£çµ)
        const ITINERARY_DATA = {
            1: {
                title: "Day 1 - æŠµé”æ±äº¬ãƒ»è¼•é¬†é©æ‡‰",
                date: "07/20 (æ—¥)",
                mapUrl: "https://www.google.com/maps/dir/æˆç”°åœ‹éš›æ©Ÿå ´/æ–°å®¿ç«™/æ­Œèˆä¼ç”º/æ€å‡ºæ©«ä¸/@35.6762,139.7649,11z/data=!3m1!4b1!4m26!4m25!1m5!1m1!1s0x6022f0d5a5f0c5f5:0x1a0b0c0d0e0f0g0h!2m2!1d140.3928!2d35.7720!1m5!1m1!1s0x60188ce0c0c0c0c1:0x1a2b3c4d5e6f7g8h!2m2!1d139.7006!2d35.6896!1m5!1m1!1s0x60188cd0c0c0c0c2:0x2a3b4c5d6e7f8g9h!2m2!1d139.7044!2d35.6938!1m5!1m1!1s0x60188cd0c0c0c0c3:0x3a4b5c6d7e8f9gah!2m2!1d139.7037!2d35.6944!3e3",
                items: [
                    {
                        time: "10:40",
                        title: "JX802 èµ·é£›",
                        description: "æ˜Ÿå®‡èˆªç©ºå¾æ¡ƒåœ’å‡ºç™¼",
                        transport: null,
                        food: "æ©Ÿä¸Šé¤",
                        highlight: "âœˆï¸ æ˜Ÿå®‡èˆªç©ºæ–°èˆªç·šï¼Œæ©Ÿä¸Šæœå‹™å“è³ªå„ªè‰¯ï¼Œé£›è¡Œæ™‚é–“ç´„3.5å°æ™‚ï¼Œé–‹å•Ÿæ±äº¬ä¹‹æ—…",
                        mapUrl: "https://www.google.com/maps/place/æ¡ƒåœ’åœ‹éš›æ©Ÿå ´/@25.0797,121.2342,15z"
                    },
                    {
                        time: "15:05",
                        title: "æŠµé”æˆç”°æ©Ÿå ´",
                        description: "å…¥å¢ƒæé ˜è¡Œæï¼Œé è¨ˆ16:00å®Œæˆ",
                        transport: null,
                        food: null,
                        highlight: "ğŸ›¬ æˆç”°åœ‹éš›æ©Ÿå ´æ˜¯æ±äº¬çš„ä¸»è¦åœ‹éš›é–€æˆ¶ï¼Œæ“æœ‰å®Œå–„çš„è³¼ç‰©å’Œé¤é£²è¨­æ–½ï¼Œå…¥å¢ƒæ‰‹çºŒç›¸å°å¿«é€Ÿ",
                        mapUrl: "https://www.google.com/maps/place/æˆç”°åœ‹éš›æ©Ÿå ´/@35.7720,140.3928,15z"
                    },
                    {
                        time: "16:15",
                        title: "å‰å¾€æ–°å®¿",
                        description: "æ­ä¹˜æˆç”°ç‰¹å¿«å‰å¾€æ–°å®¿",
                        transport: {
                            method: "ğŸš„ JR Narita Express",
                            duration: "ç´„80åˆ†é˜",
                            cost: "Â¥3,070",
                            route: "æˆç”°æ©Ÿå ´ â†’ æ–°å®¿ç«™"
                        },
                        food: null,
                        highlight: "ğŸš„ æˆç”°ç‰¹å¿«æ˜¯é€£æ¥æ©Ÿå ´èˆ‡å¸‚å€æœ€èˆ’é©çš„æ–¹å¼ï¼Œè»Šå»‚å¯¬æ•ï¼Œå¯æ¬£è³æ²¿é€”æ—¥æœ¬é„‰æ‘é¢¨å…‰",
                        mapUrl: "https://www.google.com/maps/dir/æˆç”°åœ‹éš›æ©Ÿå ´/æ–°å®¿ç«™/@35.7308,139.9967,10z"
                    },
                    {
                        time: "17:45",
                        title: "GROOVEé£¯åº— Check-in",
                        description: "æŠµé”æ–°å®¿ï¼Œè¾¦ç†å…¥ä½æ‰‹çºŒ",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„3åˆ†é˜",
                            cost: "å…è²»",
                            route: "æ–°å®¿ç«™å—å£ â†’ GROOVEé£¯åº—"
                        },
                        food: null,
                        highlight: "ğŸ¨ ä½æ–¼æ–°å®¿æ ¸å¿ƒåœ°å¸¶çš„ç¾ä»£åŒ–é£¯åº—ï¼Œäº¤é€šä¾¿åˆ©ï¼Œæˆ¿é–“é›–å°ä½†è¨­è¨ˆç²¾å·§ï¼Œé«”ç¾æ—¥æœ¬ç©ºé–“åˆ©ç”¨æ™ºæ…§",
                        mapUrl: "https://www.google.com/maps/place/Hotel+Groove+Shinjuku/@35.6896,139.7006,17z"
                    },
                    {
                        time: "18:30",
                        title: "æˆ¿é–“ä¼‘æ¯",
                        description: "èª¿æ•´æ™‚å·®ï¼Œæ¬£è³é«˜æ¨“å¤œæ™¯",
                        transport: null,
                        food: null,
                        highlight: "ğŸŒƒ æ–°å®¿é«˜æ¨“æ—ç«‹ï¼Œå¤œæ™¯ç’€ç’¨ï¼Œæ˜¯èª¿æ•´æ™‚å·®å’Œæº–å‚™æ¥ä¸‹ä¾†è¡Œç¨‹çš„æœ€ä½³æ™‚æ©Ÿ",
                        mapUrl: null
                    },
                    {
                        time: "19:30-22:00",
                        title: "æ­Œèˆä¼ç”ºæ•£æ­¥",
                        description: "é«”é©—æ±äº¬å¤œç”Ÿæ´»ï¼Œæ€å‡ºæ©«ä¸æ™šé¤",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "2-8åˆ†é˜",
                            cost: "å…è²»",
                            route: "é£¯åº—å‘¨é‚Šæ­¥è¡Œç¯„åœ"
                        },
                        food: "æ€å‡ºæ©«ä¸ã€Œé³¥åœ’ã€",
                        highlight: "ğŸ® æ­Œèˆä¼ç”ºæ˜¯æ±äº¬æœ€è‘—åçš„ä¸å¤œåŸï¼Œéœ“è™¹ç‡ˆé–ƒçˆï¼Œå……æ»¿æ˜­å’Œæ™‚ä»£æ‡·èˆŠæ°›åœçš„æ€å‡ºæ©«ä¸æ›´æ˜¯é«”é©—è€æ±äº¬æ–‡åŒ–çš„çµ•ä½³åœ°é»",
                        mapUrl: "https://www.google.com/maps/place/æ€å‡ºæ©«ä¸/@35.6944,139.7037,17z"
                    }
                ]
            },
            2: {
                title: "Day 2 - ä¸‹ç”ºæ–‡åŒ– + ç¾ä»£è—è¡“ + ç§‹è‘‰åŸå‹•æ¼«",
                date: "07/21 (ä¸€)",
                mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/æ·ºè‰å¯º/æ¿±é›¢å®®æ©è³œåº­åœ’/ç¯‰åœ°å ´å¤–å¸‚å ´/ç§‹è‘‰åŸé›»å™¨è¡—/teamLab+Planets+è±Šæ´²/@35.6762,139.7649,12z/data=!3m1!4b1!4m38!4m37!1m5!1m1!1s0x60188ce0c0c0c0c1:0x1a2b3c4d5e6f7g8h!2m2!1d139.7006!2d35.6896!1m5!1m1!1s0x60188ec0c0c0c0c1:0x1a2b3c4d5e6f7g8i!2m2!1d139.7966!2d35.7148!1m5!1m1!1s0x60188be0c0c0c0c1:0x1a2b3c4d5e6f7g8j!2m2!1d139.7637!2d35.6596!1m5!1m1!1s0x60188be0c0c0c0c2:0x2a3b4c5d6e7f8g9j!2m2!1d139.7707!2d35.6654!1m5!1m1!1s0x60188c0c0c0c0c01:0x3a4b5c6d7e8f9gak!2m2!1d139.7731!2d35.7022!1m5!1m1!1s0x601889f0c0c0c0c1:0x4a5b6c7d8e9fagbl!2m2!1d139.7946!2d35.6490!3e3",
                items: [
                    {
                        time: "07:30",
                        title: "é£¯åº—æ—©é¤",
                        description: "åœ¨é£¯åº—äº«ç”¨æ—©é¤",
                        transport: null,
                        food: "é£¯åº—æ—©é¤",
                        highlight: "ğŸ± æ—¥å¼é£¯åº—æ—©é¤é€šå¸¸åŒ…å«å’Œæ´‹å¼é¸æ“‡ï¼Œå“è³ªç²¾ç·»ï¼Œç‚ºä¸€å¤©çš„è¡Œç¨‹è£œå……èƒ½é‡",
                        mapUrl: null
                    },
                    {
                        time: "09:00",
                        title: "å‰å¾€æ·ºè‰",
                        description: "æ­ä¹˜é›»è»Šå‰å¾€æ·ºè‰å¯º",
                        transport: {
                            method: "ğŸš‡ JR+éƒ½ç‡Ÿæ·ºè‰ç·š",
                            duration: "ç´„35åˆ†é˜",
                            cost: "Â¥200",
                            route: "æ–°å®¿ â†’ æ–°æ©‹ â†’ æ·ºè‰"
                        },
                        food: null,
                        highlight: "ğŸš‡ é«”é©—æ±äº¬è¤‡é›œä½†é«˜æ•ˆçš„é›»è»Šç³»çµ±ï¼Œæº–æ™‚æ€§ä¸–ç•Œèå",
                        mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/æ·ºè‰ç«™/@35.6762,139.7649,12z"
                    },
                    {
                        time: "09:30-11:00",
                        title: "æ·ºè‰å¯ºåƒæ‹œ",
                        description: "é›·é–€æ‹ç…§ï¼Œä»²è¦‹ä¸–é€šè³¼ç‰©",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "å‡ºç«™å³é”",
                            cost: "å…è²»",
                            route: "æ·ºè‰ç«™ â†’ é›·é–€ â†’ æ·ºè‰å¯º"
                        },
                        food: "äººå½¢ç‡’",
                        highlight: "â›©ï¸ æ±äº¬æœ€å¤è€çš„å¯ºå»Ÿä¹‹ä¸€ï¼Œé›·é–€çš„å·¨å¤§ç‡ˆç± æ˜¯æ±äº¬åœ°æ¨™ï¼Œä»²è¦‹ä¸–é€šä¿ç•™äº†æ±Ÿæˆ¶æ™‚ä»£çš„å•†åº—è¡—é¢¨æƒ…ï¼Œäººå½¢ç‡’æ˜¯å¿…åšå‚³çµ±é»å¿ƒ",
                        mapUrl: "https://www.google.com/maps/place/æ·ºè‰å¯º/@35.7148,139.7966,17z"
                    },
                    {
                        time: "11:15",
                        title: "éš…ç”°å·æ°´ä¸Šå·´å£«",
                        description: "æ­ä¹˜æ°´ä¸Šå·´å£«å‰å¾€æ¿±é›¢å®®",
                        transport: {
                            method: "ğŸš¢ æ°´ä¸Šå·´å£«",
                            duration: "ç´„35åˆ†é˜",
                            cost: "Â¥1,040",
                            route: "æ·ºè‰ç¢¼é ­ â†’ æ¿±é›¢å®®ç¢¼é ­"
                        },
                        food: null,
                        highlight: "ğŸš¢ å¾æ°´ä¸Šæ¬£è³æ±äº¬å¤©éš›ç·šï¼Œå¯çœ‹åˆ°æ±äº¬éµå¡”ã€æ™´ç©ºå¡”ç­‰åœ°æ¨™ï¼Œæ˜¯ç¨ç‰¹çš„åŸå¸‚è§€å…‰é«”é©—",
                        mapUrl: "https://www.google.com/maps/dir/æ·ºè‰ç¢¼é ­/æ¿±é›¢å®®æ©è³œåº­åœ’/@35.6872,139.7802,13z"
                    },
                    {
                        time: "12:00-13:30",
                        title: "æ¿±é›¢å®®æ©è³œåº­åœ’",
                        description: "æ—¥å¼åº­åœ’æ•£æ­¥ï¼Œæ¬£è³æ±äº¬ç£æ™¯è‰²",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ ç¢¼é ­ç›´é”",
                            duration: "å³é”",
                            cost: "å…¥åœ’Â¥300",
                            route: "ç¢¼é ­ â†’ åº­åœ’å…¥å£"
                        },
                        food: null,
                        highlight: "ğŸŒ¸ æ±Ÿæˆ¶æ™‚ä»£å°‡è»çš„é›¢å®®åº­åœ’ï¼Œèåˆå‚³çµ±æ—¥å¼é€ æ™¯èˆ‡ç¾ä»£éƒ½å¸‚æ™¯è§€ï¼Œæ˜¥å­£æ«»èŠ±ã€ç§‹å­£ç´…è‘‰éƒ½éå¸¸ç¾éº—",
                        mapUrl: "https://www.google.com/maps/place/æ¿±é›¢å®®æ©è³œåº­åœ’/@35.6596,139.7637,17z"
                    },
                    {
                        time: "14:00-15:30",
                        title: "ç¯‰åœ°å ´å¤–å¸‚å ´",
                        description: "å“åšæ–°é®®æµ·é®®ä¸¼",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„10åˆ†é˜",
                            cost: "å…è²»",
                            route: "æ¿±é›¢å®® â†’ ç¯‰åœ°å ´å¤–"
                        },
                        food: "æµ·é®®ä¸¼",
                        highlight: "ğŸŸ é›–ç„¶ç¯‰åœ°å¸‚å ´å·²é·ç§»ï¼Œä½†å ´å¤–å¸‚å ´ä¾ç„¶ä¿æŒå‚³çµ±ï¼Œæ–°é®®æµ·ç”¢ã€ç‰å­ç‡’ã€é®ªé­šç­‰ç¾é£Ÿæ‡‰æœ‰ç›¡æœ‰ï¼Œæ˜¯è€é¥•å¿…è¨ªä¹‹åœ°",
                        mapUrl: "https://www.google.com/maps/place/ç¯‰åœ°å ´å¤–å¸‚å ´/@35.6654,139.7707,17z"
                    },
                    {
                        time: "16:00-18:00",
                        title: "ç§‹è‘‰åŸé›»å™¨è¡— - å‹•ç•«æ¨¡å‹æ¡è³¼",
                        description: "å‹•æ¼«è–åœ°å·¡ç¦®ï¼Œè³¼è²·é™å®šæ¨¡å‹å’Œå‘¨é‚Šå•†å“",
                        transport: {
                            method: "ğŸš‡ éƒ½ç‡Ÿå¤§æ±Ÿæˆ¶ç·š+JR",
                            duration: "ç´„20åˆ†é˜",
                            cost: "Â¥280",
                            route: "ç¯‰åœ°å¸‚å ´ â†’ æ–°æ©‹ â†’ ç§‹è‘‰åŸ"
                        },
                        food: "å¥³åƒ•å’–å•¡å»³",
                        highlight: "ğŸ¤– ä¸–ç•ŒçŸ¥åçš„é›»å™¨å’Œå‹•æ¼«æ–‡åŒ–ä¸­å¿ƒï¼Œå¾æœ€æ–°çš„é›»å­ç”¢å“åˆ°ç¨€æœ‰çš„å‹•ç•«æ¨¡å‹æ‡‰æœ‰ç›¡æœ‰ï¼Œå¥³åƒ•å’–å•¡å»³æ˜¯ç¨ç‰¹çš„æ—¥æœ¬æ¬¡æ–‡åŒ–é«”é©—",
                        mapUrl: "https://www.google.com/maps/place/ç§‹è‘‰åŸé›»å™¨è¡—/@35.7022,139.7731,17z"
                    },
                    {
                        time: "18:30-20:30",
                        title: "teamLab Planets è±Šæ´²",
                        description: "æ²‰æµ¸å¼æ•¸ä½è—è¡“é«”é©—",
                        transport: {
                            method: "ğŸš‡ JR+ç™¾åˆæµ·é·—ç·š",
                            duration: "ç´„25åˆ†é˜",
                            cost: "Â¥320",
                            route: "ç§‹è‘‰åŸ â†’ æ–°æ©‹ â†’ è±Šæ´²"
                        },
                        food: null,
                        highlight: "ğŸ¨ ä¸–ç•ŒçŸ¥åçš„æ•¸ä½è—è¡“åœ˜éšŠä½œå“ï¼Œçµåˆç§‘æŠ€èˆ‡è—è¡“ï¼Œå‰µé€ å‡ºå¤¢å¹»çš„æ²‰æµ¸å¼é«”é©—ï¼Œéœ€èµ¤è…³é«”é©—ï¼Œèˆ‡è—è¡“å“äº’å‹•",
                        mapUrl: "https://www.google.com/maps/place/teamLab+Planets+TOKYO/@35.6490,139.7946,17z"
                    },
                    {
                        time: "21:30",
                        title: "å›æ–°å®¿æ™šé¤",
                        description: "å›åˆ°æ–°å®¿äº«ç”¨æ‹‰éºµ",
                        transport: {
                            method: "ğŸš‡ ç™¾åˆæµ·é·—ç·š+JR",
                            duration: "ç´„35åˆ†é˜",
                            cost: "Â¥320",
                            route: "è±Šæ´² â†’ æ–°æ©‹ â†’ æ–°å®¿"
                        },
                        food: "ä¸€è˜­æ‹‰éºµ",
                        highlight: "ğŸœ ä¸€è˜­æ‹‰éºµçš„ã€Œä¸€äººä¸€æ ¼ã€ç”¨é¤æ–¹å¼æ˜¯ç¨ç‰¹çš„æ—¥æœ¬æ–‡åŒ–é«”é©—ï¼Œå¯å°ˆå¿ƒå“åšæ‹‰éºµçš„ç¾å‘³",
                        mapUrl: "https://www.google.com/maps/place/ä¸€è˜­æ‹‰éºµ+æ–°å®¿åº—/@35.6896,139.7006,17z"
                    }
                ]
            },
            3: {
                title: "Day 3 - åŸå®¿æ¾€è°·æ½®æµ + è½‰ä½Gracery",
                date: "07/22 (äºŒ)",
                mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/æ˜æ²»ç¥å®®/ç«¹ä¸‹é€š/è¡¨åƒé“Hills/æ¾€è°·109/Soccer+Shop+KAMO+æ¾€è°·åº—/Shibuya+Sky/@35.6762,139.7649,13z/data=!3m1!4b1!4m44!4m43!1m5!1m1!1s0x60188ce0c0c0c0c1:0x1a2b3c4d5e6f7g8h!2m2!1d139.7006!2d35.6896!1m5!1m1!1s0x60188ca0c0c0c0c1:0x1a2b3c4d5e6f7g8k!2m2!1d139.6993!2d35.6764!1m5!1m1!1s0x60188ca0c0c0c0c2:0x2a3b4c5d6e7f8g9k!2m2!1d139.7028!2d35.6702!1m5!1m1!1s0x60188ca0c0c0c0c3:0x3a4b5c6d7e8f9gak!2m2!1d139.7117!2d35.6657!1m5!1m1!1s0x60188ca0c0c0c0c4:0x4a5b6c7d8e9fagbl!2m2!1d139.7010!2d35.6598!1m5!1m1!1s0x60188ca0c0c0c0c5:0x5a6b7c8d9eafbgcm!2m2!1d139.7016!2d35.6580!1m5!1m1!1s0x60188ca0c0c0c0c6:0x6a7b8c9daeafbgcdn!2m2!1d139.7016!2d35.6590!3e3",
                items: [
                    {
                        time: "07:30",
                        title: "GROOVE é€€æˆ¿",
                        description: "é€€æˆ¿å¾Œæ­¥è¡Œè‡³ Gracery å¯„è¡Œæ",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ/è¨ˆç¨‹è»Š",
                            duration: "ç´„8åˆ†é˜",
                            cost: "æ­¥è¡Œå…è²»/è¨ˆç¨‹è»ŠÂ¥730",
                            route: "GROOVE â†’ Gracery"
                        },
                        food: "ä¾¿åˆ©åº—æ—©é¤",
                        highlight: "ğŸª æ—¥æœ¬ä¾¿åˆ©åº—æ—©é¤é¸æ“‡è±å¯Œï¼Œé£¯ç³°ã€ä¸‰æ˜æ²»ã€å’–å•¡å“è³ªéƒ½å¾ˆé«˜ï¼Œæ˜¯å¿«é€Ÿè§£æ±ºæ—©é¤çš„å¥½é¸æ“‡",
                        mapUrl: "https://www.google.com/maps/dir/Hotel+Groove+Shinjuku/Hotel+Gracery+Shinjuku/@35.6896,139.7006,17z"
                    },
                    {
                        time: "08:00",
                        title: "å‰å¾€åŸå®¿",
                        description: "æ­ä¹˜å±±æ‰‹ç·šå‰å¾€åŸå®¿ç«™",
                        transport: {
                            method: "ğŸš‡ JRå±±æ‰‹ç·š",
                            duration: "ç´„7åˆ†é˜",
                            cost: "Â¥160",
                            route: "æ–°å®¿ â†’ åŸå®¿"
                        },
                        food: null,
                        highlight: "ğŸš‡ å±±æ‰‹ç·šæ˜¯æ±äº¬æœ€é‡è¦çš„ç’°ç‹€ç·šï¼Œé€£æ¥æ‰€æœ‰ä¸»è¦å€åŸŸ",
                        mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/åŸå®¿ç«™/@35.6829,139.7000,14z"
                    },
                    {
                        time: "08:30-10:00",
                        title: "æ˜æ²»ç¥å®®åƒæ‹œ",
                        description: "æ±äº¬æœ€é‡è¦çš„ç¥ç¤¾åƒæ‹œ",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„3åˆ†é˜",
                            cost: "å…è²»",
                            route: "åŸå®¿ç«™è¥¿å£ â†’ æ˜æ²»ç¥å®®"
                        },
                        food: null,
                        highlight: "â›©ï¸ ä¾›å¥‰æ˜æ²»å¤©çš‡çš„ç¥ç¤¾ï¼Œæ“æœ‰æ±äº¬å¸‚å€æœ€å¤§çš„æ£®æ—ï¼Œæ¸…æ™¨åƒæ‹œå¯æ„Ÿå—å¯§éœç¥è–çš„æ°›åœï¼Œæ˜¯æ±äº¬çš„ç²¾ç¥è±¡å¾µ",
                        mapUrl: "https://www.google.com/maps/place/æ˜æ²»ç¥å®®/@35.6764,139.6993,17z"
                    },
                    {
                        time: "10:15-11:30",
                        title: "ç«¹ä¸‹é€šé€›è¡—",
                        description: "é’å°‘å¹´æ–‡åŒ–è–åœ°è³¼ç‰©",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„3åˆ†é˜",
                            cost: "å…è²»",
                            route: "æ˜æ²»ç¥å®® â†’ ç«¹ä¸‹é€š"
                        },
                        food: "å½©è™¹æ£‰èŠ±ç³–",
                        highlight: "ğŸŒˆ æ—¥æœ¬æµè¡Œæ–‡åŒ–çš„ç™¼æºåœ°ï¼Œå¯æ„›æ–‡åŒ–ã€åŸå®¿é¢¨æ ¼çš„é›†ä¸­åœ°ï¼Œå½©è™¹æ£‰èŠ±ç³–ç­‰å‰µæ„ç¾é£Ÿæ˜¯Instagramç†±é–€æ‰“å¡é»",
                        mapUrl: "https://www.google.com/maps/place/ç«¹ä¸‹é€š/@35.6702,139.7028,17z"
                    },
                    {
                        time: "11:45-14:00",
                        title: "è¡¨åƒé“ç²¾å“è¡—",
                        description: "é«˜ç´šç²¾å“è³¼ç‰© + åˆé¤",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„10åˆ†é˜",
                            cost: "å…è²»",
                            route: "ç«¹ä¸‹é€š â†’ è¡¨åƒé“Hills"
                        },
                        food: "ç‰›ã‹ã¤ã‚‚ã¨æ‘",
                        highlight: "ğŸ¬ æ±äº¬çš„é¦™æ¦­éº—èˆå¤§é“ï¼ŒåŒ¯é›†åœ‹éš›ç²¾å“æ——è‰¦åº—ï¼Œå»ºç¯‰è¨­è¨ˆä¹Ÿæ˜¯ä¸€å¤§çœ‹é»ï¼Œç‰›ã‹ã¤ã‚‚ã¨æ‘çš„ç‚¸ç‰›æ’æ˜¯å¿…åšç¾é£Ÿ",
                        mapUrl: "https://www.google.com/maps/place/è¡¨åƒé“Hills/@35.6657,139.7117,17z"
                    },
                    {
                        time: "14:30-15:30",
                        title: "æ¾€è°·è³¼ç‰© - 109",
                        description: "æ¾€è°·109è³¼ç‰©ä¸­å¿ƒï¼Œæ—¥æœ¬æµè¡Œæ™‚å°šè–åœ°",
                        transport: {
                            method: "ğŸš‡ æ±äº¬MetroåŠè—é–€ç·š",
                            duration: "ç´„3åˆ†é˜",
                            cost: "Â¥170",
                            route: "è¡¨åƒé“ â†’ æ¾€è°·"
                        },
                        food: null,
                        highlight: "ğŸ›ï¸ æ—¥æœ¬æœ€å…·ä»£è¡¨æ€§çš„æµè¡Œæ™‚å°šè³¼ç‰©ä¸­å¿ƒï¼ŒåŒ¯é›†æœ€æ–°æ½®æµå“ç‰Œï¼Œæ˜¯é«”é©—æ—¥æœ¬å¹´è¼•äººæ–‡åŒ–çš„æœ€ä½³åœ°é»",
                        mapUrl: "https://www.google.com/maps/place/æ¾€è°·109/@35.6598,139.7010,17z"
                    },
                    {
                        time: "15:45-17:15",
                        title: "Soccer Shop KAMO æ¾€è°·åº—",
                        description: "æ—¥æœ¬çŸ¥åè¶³çƒç”¨å“å°ˆè³£åº—ï¼Œå„ç¨®è¶³çƒç›¸é—œå•†å“æ‡‰æœ‰ç›¡æœ‰",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„5åˆ†é˜",
                            cost: "å…è²»",
                            route: "æ¾€è°·109 â†’ Soccer Shop KAMO"
                        },
                        food: null,
                        highlight: "âš½ æ—¥æœ¬æœ€å¤§çš„è¶³çƒå°ˆé–€åº—ä¹‹ä¸€ï¼Œæ“æœ‰è±å¯Œçš„æ—¥æœ¬åœ‹å®¶éšŠã€Jè¯ç›Ÿçƒè¡£æ”¶è—ï¼Œé‚„æœ‰é™å®šç‰ˆçƒé‹å’Œç¨€æœ‰è¶³çƒç”¨å“ï¼Œè¶³çƒè¿·çš„å¤©å ‚",
                        mapUrl: "https://www.google.com/maps/place/Soccer+Shop+KAMO+æ¾€è°·åº—/@35.6580,139.7016,17z"
                    },
                    {
                        time: "17:30-18:30",
                        title: "Shibuya Sky å¤•é™½",
                        description: "æ¾€è°·å¤©ç©ºå±•æœ›å°çœ‹å¤•é™½",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ",
                            duration: "ç´„3åˆ†é˜",
                            cost: "å…¥å ´Â¥2,000",
                            route: "Soccer Shop â†’ Skyå±•æœ›å°"
                        },
                        food: null,
                        highlight: "ğŸŒ… æ±äº¬æœ€æ–°çš„å¤©ç©ºè§€æ™¯å°ï¼Œ360åº¦ä¿¯ç°æ±äº¬å…¨æ™¯ï¼Œå¤•é™½æ™‚åˆ†æ˜¯æœ€ä½³æ‹ç…§æ™‚æ©Ÿï¼Œå¯å°‡å¯Œå£«å±±ã€æ±äº¬éµå¡”ç›¡æ”¶çœ¼åº•",
                        mapUrl: "https://www.google.com/maps/place/Shibuya+Sky/@35.6590,139.7016,17z"
                    },
                    {
                        time: "18:45",
                        title: "æ¾€è°·åå­—è·¯å£",
                        description: "ä¸–ç•Œæœ€ç¹å¿™åå­—è·¯å£æ‹ç…§",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ ä¸‹æ¨“å³é”",
                            duration: "å³é”",
                            cost: "å…è²»",
                            route: "Sky â†’ åå­—è·¯å£"
                        },
                        food: null,
                        highlight: "ğŸš¦ ä¸–ç•Œæœ€ç¹å¿™çš„åå­—è·¯å£ï¼Œæ¯æ¬¡ç¶ ç‡ˆå¯æœ‰3000äººåŒæ™‚é€šéï¼Œæ˜¯æ±äº¬ç¾ä»£éƒ½å¸‚ç”Ÿæ´»çš„è±¡å¾µï¼Œå¤œæ™šéœ“è™¹ç‡ˆæ•ˆæœæ›´ä½³",
                        mapUrl: "https://www.google.com/maps/place/æ¾€è°·åå­—è·¯å£/@35.6598,139.7010,17z"
                    },
                    {
                        time: "19:30",
                        title: "å›æ–°å®¿ Check-in",
                        description: "å›åˆ°æ–°å®¿ Gracery è¾¦ç†å…¥ä½",
                        transport: {
                            method: "ğŸš‡ JRå±±æ‰‹ç·š",
                            duration: "ç´„7åˆ†é˜",
                            cost: "Â¥160",
                            route: "æ¾€è°· â†’ æ–°å®¿"
                        },
                        food: "é³¥è²´æ—ä¸²ç‡’",
                                               highlight: "ğŸ¨ Graceryé£¯åº—ä»¥å“¥å‰æ‹‰ç‚ºä¸»é¡Œï¼Œé ‚æ¨“æœ‰å·¨å¤§å“¥å‰æ‹‰é ­åƒï¼Œæ˜¯ç¨ç‰¹çš„ä½å®¿é«”é©—ï¼›é³¥è²´æ—æ˜¯å¹³åƒ¹ä¸²ç‡’é€£é–åº—",
                        mapUrl: "https://www.google.com/maps/place/Hotel+Gracery+Shinjuku/@35.6896,139.7006,17z"
                    }
                ]
            },
            4: {
                title: "Day 4 - Tokyo Disneyland æ”»ç•¥æ—¥",
                date: "07/23 (ä¸‰)",
                mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/èˆæ¿±ç«™/æ±äº¬è¿ªå£«å°¼æ¨‚åœ’/@35.6762,139.7649,11z/data=!3m1!4b1!4m20!4m19!1m5!1m1!1s0x60188ce0c0c0c0c1:0x1a2b3c4d5e6f7g8h!2m2!1d139.7006!2d35.6896!1m5!1m1!1s0x601885c0c0c0c0c1:0x1a2b3c4d5e6f7g8o!2m2!1d139.8836!2d35.6347!1m5!1m1!1s0x601885d0c0c0c0c1:0x2a3b4c5d6e7f8g9o!2m2!1d139.8781!2d35.6329!3e3",
                items: [
                    {
                        time: "06:30",
                        title: "æ—©é¤ + å‡ºç™¼",
                        description: "Graceryæ—©é¤å¾Œæº–å‚™å‡ºç™¼",
                        transport: null,
                        food: "é£¯åº—æ—©é¤",
                        highlight: "ğŸ° è¿ªå£«å°¼æ”»ç•¥æ—¥éœ€è¦å……è¶³é«”åŠ›ï¼Œæ—©èµ·æ˜¯ç‚ºäº†é¿é–‹äººæ½®ï¼ŒæŠŠæ¡é»ƒé‡‘éŠç©æ™‚é–“",
                        mapUrl: null
                    },
                    {
                        time: "07:06",
                        title: "å‰å¾€è¿ªå£«å°¼",
                        description: "æ­ä¹˜JRå‰å¾€èˆæ¿±ç«™",
                        transport: {
                            method: "ğŸš‡ JRä¸­å¤®ç·š+äº¬è‘‰ç·š",
                            duration: "ç´„45åˆ†é˜",
                            cost: "Â¥390",
                            route: "æ–°å®¿ â†’ æ±äº¬ â†’ èˆæ¿±"
                        },
                        food: null,
                        highlight: "ğŸš„ äº¬è‘‰ç·šæ˜¯å‰å¾€è¿ªå£«å°¼çš„å°ˆç”¨ç·šè·¯ï¼Œè»Šçª—å¯çœ‹åˆ°æ±äº¬ç£æ™¯è‰²",
                        mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/èˆæ¿±ç«™/@35.6622,139.7921,11z"
                    },
                    {
                        time: "08:00",
                        title: "æŠµé”è¿ªå£«å°¼æ¨‚åœ’",
                        description: "é–‹åœ’å‰æ’éšŠå…¥å ´",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ­¥è¡Œ/åº¦å‡å€ç·š",
                            duration: "ç´„5åˆ†é˜",
                            cost: "æ­¥è¡Œå…è²»/Â¥260",
                            route: "èˆæ¿±ç«™ â†’ è¿ªå£«å°¼æ¨‚åœ’"
                        },
                        food: null,
                        highlight: "ğŸ¢ æ±äº¬è¿ªå£«å°¼æ¨‚åœ’æ˜¯äºæ´²ç¬¬ä¸€åº§è¿ªå£«å°¼æ¨‚åœ’ï¼Œä¿æŒè‘—æœ€é«˜çš„æœå‹™å“è³ªå’Œç¨ç‰¹çš„æ—¥å¼ç´°è†©",
                        mapUrl: "https://www.google.com/maps/place/æ±äº¬è¿ªå£«å°¼æ¨‚åœ’/@35.6329,139.8781,17z"
                    },
                    {
                        time: "08:15-12:00",
                        title: "ä¸Šåˆé«˜æ•ˆæ”»ç•¥",
                        description: "å¾å³å´é–‹å§‹é †æ™‚é‡éŠç©ç†±é–€è¨­æ–½",
                        transport: {
                            method: "ğŸ¢ åœ’å€å…§æ­¥è¡Œ",
                            duration: "å–„ç”¨AppæŸ¥è©¢",
                            cost: "å…¥åœ’Â¥10,900",
                            route: "å³å´â†’é †æ™‚é‡è·¯ç·š"
                        },
                        food: null,
                        highlight: "ğŸ¯ å»ºè­°å…ˆç©å¤ªç©ºå±±ã€å·¨é›·å±±ç­‰ç†±é–€è¨­æ–½ï¼Œä½¿ç”¨è¿ªå£«å°¼Appå¯æŸ¥çœ‹ç­‰å€™æ™‚é–“ï¼Œæé«˜éŠç©æ•ˆç‡",
                        mapUrl: null
                    },
                    {
                        time: "12:00-13:00",
                        title: "Queen of Hearts åˆé¤",
                        description: "æ„›éº—çµ²ä¸»é¡Œé¤å»³ç”¨é¤",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ åœ’å€å…§æ­¥è¡Œ",
                            duration: "ä½æ–¼å¤¢å¹»æ¨‚åœ’",
                            cost: "é¤è²»ç´„Â¥2,500",
                            route: "åœ’å€å…§ç§»å‹•"
                        },
                        food: "ä¸»é¡Œé¤å»³å¥—é¤",
                        highlight: "ğŸ«– æ„›éº—çµ²å¤¢éŠä»™å¢ƒä¸»é¡Œé¤å»³ï¼Œé¤å…·å’Œè£æ½¢éƒ½å……æ»¿ç«¥è©±è‰²å½©ï¼Œæ˜¯è¿ªå£«å°¼ç¨æœ‰çš„ç”¨é¤é«”é©—",
                        mapUrl: null
                    },
                    {
                        time: "13:00-17:30",
                        title: "ä¸‹åˆéŠç©",
                        description: "å®¤å…§è¨­æ–½é¿æš‘ï¼Œè³¼ç‰©ä¼‘æ¯",
                        transport: {
                            method: "ğŸ¢ åœ’å€å…§ç§»å‹•",
                            duration: "å¤šåˆ©ç”¨å®¤å…§è¨­æ–½",
                            cost: "å•†å“è²»ç”¨",
                            route: "åœ’å€å…§å„å€åŸŸ"
                        },
                        food: "ç±³å¥‡é›è…¿",
                        highlight: "ğŸ— ç±³å¥‡é€ å‹é›è…¿æ˜¯è¿ªå£«å°¼ç¶“å…¸ç¾é£Ÿï¼Œä¸‹åˆå¯åœ¨å®¤å…§è¨­æ–½å¦‚å°å°ä¸–ç•Œã€é¬¼å±‹ç­‰é¿æš‘",
                        mapUrl: null
                    },
                    {
                        time: "18:45",
                        title: "å¡ä½ç­‰å¤œé–“éŠè¡Œ",
                        description: "åœ¨åŸå ¡å‰å»£å ´å¡ä½",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ éŠè¡Œè·¯ç·šå¡ä½",
                            duration: "æå‰45åˆ†é˜",
                            cost: "å…è²»",
                            route: "åŸå ¡å‰å»£å ´"
                        },
                        food: null,
                        highlight: "âœ¨ å¤œé–“éŠè¡Œæ˜¯è¿ªå£«å°¼çš„é‡é ­æˆ²ï¼Œç‡ˆå…‰æ•ˆæœçµ¢çˆ›ï¼Œå»ºè­°æå‰å¡ä½å–å¾—æœ€ä½³è§€è³ä½ç½®",
                        mapUrl: null
                    },
                    {
                        time: "19:30-20:00",
                        title: "Electrical Parade",
                        description: "æ±äº¬è¿ªå£«å°¼ç¶“å…¸å¤œé–“éŠè¡Œ",
                        transport: null,
                        food: null,
                        highlight: "ğŸ† æ±äº¬è¿ªå£«å°¼é›»å­å¤§éŠè¡Œæ˜¯ä¸–ç•ŒçŸ¥åçš„å¤œé–“è¡¨æ¼”ï¼ŒçµåˆéŸ³æ¨‚ã€ç‡ˆå…‰ã€èŠ±è»Šï¼Œå¸¶ä¾†å¤¢å¹»é«”é©—",
                        mapUrl: null
                    },
                    {
                        time: "21:30",
                        title: "å›æ–°å®¿",
                        description: "æ­ä¹˜JRå›åˆ°æ–°å®¿",
                        transport: {
                            method: "ğŸš‡ JRäº¬è‘‰ç·š+ä¸­å¤®ç·š",
                            duration: "ç´„45åˆ†é˜",
                            cost: "Â¥390",
                            route: "èˆæ¿± â†’ æ±äº¬ â†’ æ–°å®¿"
                        },
                        food: "å±±é ­ç«æ‹‰éºµ",
                        highlight: "ğŸœ å±±é ­ç«æ‹‰éºµä»¥ç™½æ¹¯è±šéª¨æ‹‰éºµèåï¼Œæ˜¯çµæŸè¿ªå£«å°¼ä¸€æ—¥éŠçš„å®Œç¾å¥è™Ÿ",
                        mapUrl: "https://www.google.com/maps/place/å±±é ­ç«æ‹‰éºµ+æ–°å®¿åº—/@35.6896,139.7006,17z"
                    }
                ]
            },
            5: {
                title: "Day 5 - æ¡è²·è¿”å°",
                date: "07/24 (å››)",
                mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/BICQLO/Loft+æ–°å®¿åº—/Don+Quijote+æ–°å®¿æ±å—å£åº—/æˆç”°åœ‹éš›æ©Ÿå ´/@35.6762,139.7649,10z/data=!3m1!4b1!4m32!4m31!1m5!1m1!1s0x60188ce0c0c0c0c1:0x1a2b3c4d5e6f7g8h!2m2!1d139.7006!2d35.6896!1m5!1m1!1s0x60188ce0c0c0c0c2:0x2a3b4c5d6e7f8g9h!2m2!1d139.7010!2d35.6900!1m5!1m1!1s0x60188ce0c0c0c0c3:0x3a4b5c6d7e8f9gah!2m2!1d139.7020!2d35.6890!1m5!1m1!1s0x60188ce0c0c0c0c4:0x4a5b6c7d8e9fagbh!2m2!1d139.7030!2d35.6880!1m5!1m1!1s0x6022f0d5a5f0c5f5:0x1a0b0c0d0e0f0g0h!2m2!1d140.3928!2d35.7720!3e3",
                items: [
                    {
                        time: "07:30",
                        title: "æ—©é¤ + é€€æˆ¿",
                        description: "Graceryæ—©é¤å¾Œé€€æˆ¿å¯„è¡Œæ",
                        transport: null,
                        food: "é£¯åº—æ—©é¤",
                        highlight: "ğŸ§³ æœ€å¾Œä¸€å¤©çš„è¡Œææ•´ç†å¾ˆé‡è¦ï¼Œå–„ç”¨é£¯åº—å¯„æ”¾æœå‹™ï¼Œè¼•é¬†è³¼ç‰©",
                        mapUrl: null
                    },
                    {
                        time: "09:00-11:00",
                        title: "æœ€å¾Œæ¡è²·",
                        description: "æ–°å®¿ç«™å‘¨é‚Šæœ€å¾Œè³¼ç‰©",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æ–°å®¿ç«™å‘¨é‚Šæ­¥è¡Œ",
                            duration: "å…¨éƒ¨å¾’æ­¥å¯é”",
                            cost: "å…è²»",
                            route: "BICQLOâ†’Loftâ†’Don Quijote"
                        },
                        food: "å“ˆæ ¹é”æ–¯",
                        highlight: "ğŸ›’ æ–°å®¿æ˜¯è³¼ç‰©å¤©å ‚ï¼ŒBICQLOçµåˆå„ªè¡£åº«å’ŒBIC Cameraã€Loftæœ‰å‰µæ„å•†å“ã€Don Quijoteæ˜¯24å°æ™‚é©šå®‰æ®¿å ‚",
                        mapUrl: "https://www.google.com/maps/place/BICQLO+æ–°å®¿æ±å£åº—/@35.6900,139.7010,17z"
                    },
                    {
                        time: "11:20",
                        title: "å‰å¾€æˆç”°æ©Ÿå ´",
                        description: "æ­ä¹˜æˆç”°ç‰¹å¿«å‰å¾€æ©Ÿå ´",
                        transport: {
                            method: "ğŸš„ JR Narita Express",
                            duration: "ç´„80åˆ†é˜",
                            cost: "ä½¿ç”¨ä¾†å›åˆ¸",
                            route: "æ–°å®¿ â†’ æˆç”°æ©Ÿå ´T2"
                        },
                        food: "N'EXä¾¿ç•¶",
                        highlight: "ğŸš„ æˆç”°ç‰¹å¿«çš„ä¾¿ç•¶å“è³ªå¾ˆé«˜ï¼Œå¯åœ¨è»Šä¸Šäº«ç”¨æœ€å¾Œçš„æ—¥å¼ç¾é£Ÿ",
                        mapUrl: "https://www.google.com/maps/dir/æ–°å®¿ç«™/æˆç”°åœ‹éš›æ©Ÿå ´/@35.7308,139.9967,10z"
                    },
                    {
                        time: "13:30",
                        title: "æ©Ÿå ´å ±åˆ° + é€€ç¨…",
                        description: "æ˜Ÿå®‡æ«ƒæª¯å ±åˆ°ï¼Œ4Fé€€ç¨…",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ æˆç”°T2å…§ç§»å‹•",
                            duration: "é ç•™å……è¶³æ™‚é–“",
                            cost: "å…è²»",
                            route: "D/Eå€æ«ƒæª¯â†’é€€ç¨…æ«ƒæª¯"
                        },
                        food: null,
                        highlight: "ğŸ’° æ—¥æœ¬é€€ç¨…æ‰‹çºŒç›¸å°ç°¡å–®ï¼Œè¨˜å¾—æ”œå¸¶è­·ç…§å’Œè³¼ç‰©æ”¶æ“šï¼Œå¯é€€8%æ¶ˆè²»ç¨…",
                        mapUrl: "https://www.google.com/maps/place/æˆç”°åœ‹éš›æ©Ÿå ´+ç¬¬2èˆªå»ˆ/@35.7720,140.3928,17z"
                    },
                    {
                        time: "14:30-16:00",
                        title: "å…ç¨…åº—æ¡è³¼",
                        description: "æœ€å¾Œä¼´æ‰‹ç¦®æ¡è³¼",
                        transport: {
                            method: "ğŸš¶â€â™‚ï¸ å…ç¨…åº—å€åŸŸ",
                            duration: "é ç•™å……è¶³æ™‚é–“",
                            cost: "å•†å“è²»ç”¨",
                            route: "æˆç”°æ©Ÿå ´å…ç¨…åº—"
                        },
                        food: null,
                        highlight: "ğŸ æˆç”°æ©Ÿå ´å…ç¨…åº—å•†å“é½Šå…¨ï¼Œå¾æ—¥æœ¬é…’ã€é›¶é£Ÿåˆ°åŒ–å¦å“æ‡‰æœ‰ç›¡æœ‰ï¼Œæ˜¯æœ€å¾Œè³¼è²·ä¼´æ‰‹ç¦®çš„å¥½æ©Ÿæœƒ",
                        mapUrl: null
                    },
                    {
                        time: "16:20",
                        title: "JX803èµ·é£›",
                        description: "æ˜Ÿå®‡èˆªç©ºè¿”å›æ¡ƒåœ’",
                        transport: null,
                        food: "æ©Ÿä¸Šé¤",
                        highlight: "âœˆï¸ å¸¶è‘—æ»¿æ»¿çš„å›æ†¶å’Œæˆ°åˆ©å“è¿”å›å°ç£ï¼ŒçµæŸç²¾å½©çš„æ±äº¬äº”æ—¥éŠ",
                        mapUrl: null
                    },
                    {
                        time: "19:00",
                        title: "æŠµé”æ¡ƒåœ’",
                        description: "é †åˆ©è¿”å›å°ç£",
                        transport: {
                            method: "ğŸš„ æ©Ÿæ·+é«˜éµ",
                            duration: "å¯ç•¶å¤©å›å°ä¸­",
                            cost: "ä¾å€‹äººéœ€æ±‚",
                            route: "æ¡ƒåœ’â†’å°åŒ—â†’å°ä¸­"
                        },
                        food: null,
                        highlight: "ğŸ  å›åˆ°æº«æš–çš„å®¶ï¼Œé–‹å§‹æ•´ç†ç…§ç‰‡å’Œå›æ†¶ï¼Œè¨ˆåŠƒä¸‹æ¬¡çš„æ—¥æœ¬ä¹‹æ—…",
                        mapUrl: "https://www.google.com/maps/place/æ¡ƒåœ’åœ‹éš›æ©Ÿå ´/@25.0797,121.2342,15z"
                    }
                ]
            }
        };

        // é è¨­å¾…è¾¦æ¸…å–®è³‡æ–™
        const DEFAULT_CHECKLIST = {
            'online-booking': [
                'è¿ªå£«å°¼æ¨‚åœ’é–€ç¥¨é è³¼',
                'teamLab Planets é ç´„',
                'Shibuya Sky å±•æœ›å°é ç´„',
                'æˆç”°ç‰¹å¿« N\'EX é ç´„æŒ‡å®šå¸­',
                'é£¯åº— Check-in ç·šä¸Šè¾¦ç†',
                'æ—¥æœ¬ä¸Šç¶²å¡/WiFiæ©Ÿé è¨‚',
                'æ—…éŠä¿éšªæŠ•ä¿'
            ],
            'packing-list': [
                'è­·ç…§ (æ•ˆæœŸ6å€‹æœˆä»¥ä¸Š)',
                'å°èƒè­‰ (å‚™ç”¨)',
                'ä¿¡ç”¨å¡ + ç¾é‡‘',
                'å……é›»å™¨ + è¡Œå‹•é›»æº',
                'ç›¸æ©Ÿ + è¨˜æ†¶å¡',
                'å¸¸ç”¨è—¥å“',
                'é›¨å‚˜/é›¨è¡£',
                'èˆ’é©æ­¥è¡Œé‹',
                'è¼•ä¾¿å¤–å¥—',
                'ç›¥æ´—ç”¨å“'
            ],
            'documents': [
                'æ©Ÿç¥¨é›»å­ç¥¨æ ¹åˆ—å°',
                'é£¯åº—è¨‚æˆ¿ç¢ºèªå–®',
                'æ—…éŠè¡Œç¨‹è¡¨åˆ—å°',
                'ç·Šæ€¥è¯çµ¡äººè³‡æ–™',
                'é‡è¦è­‰ä»¶å½±æœ¬',
                'æ—…éŠä¿éšªå–®',
                'ä¿¡ç”¨å¡æµ·å¤–åˆ·å¡é–‹é€š',
                'æ‰‹æ©Ÿæ¼«éŠ/ä¸Šç¶²è¨­å®š'
            ]
        };

        // DOM è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        function initializeApp() {
            setupEventListeners();
            loadItinerary(1);
            loadBudgetCalculator();
            loadChecklist();
            loadNotes();
        }

        // è¨­å®šäº‹ä»¶ç›£è½å™¨
        function setupEventListeners() {
            // å°èˆªé¸å–®åˆ‡æ›
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    switchTab(tabName);
                });
            });

            // æ—¥æœŸé¸æ“‡å™¨
            document.querySelectorAll('.day-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const day = parseInt(this.dataset.day);
                    loadItinerary(day);
                });
            });

            // è·¯ç·šæŸ¥è©¢
            document.getElementById('search-route').addEventListener('click', searchRoute);

            // é ç®—è¨ˆç®—
            document.getElementById('people-count').addEventListener('input', calculateBudget);
            document.querySelectorAll('.expense-input').forEach(input => {
                input.addEventListener('input', calculateBudget);
            });

            // å¾…è¾¦æ¸…å–®
            document.getElementById('add-item').addEventListener('click', addChecklistItem);
            document.getElementById('new-item').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addChecklistItem();
                }
            });

            // æ—…éŠç­†è¨˜
            document.getElementById('save-note').addEventListener('click', saveNote);

            // æµ®å‹•æŒ‰éˆ•
            document.getElementById('share-btn').addEventListener('click', shareItinerary);
            document.getElementById('offline-btn').addEventListener('click', downloadOffline);
        }

        // åˆ‡æ›åˆ†é 
        function switchTab(tabName) {
            // æ›´æ–°å°èˆªæŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // æ›´æ–°å…§å®¹å€åŸŸ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
        }

        // è¼‰å…¥è¡Œç¨‹å…§å®¹ (ä¿®æ”¹ç‰ˆï¼ŒåŠ å…¥Googleåœ°åœ–é€£çµ)
        function loadItinerary(day) {
            currentDay = day;
            
            // æ›´æ–°æ—¥æœŸæŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.day-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-day="${day}"]`).classList.add('active');

            // è¼‰å…¥è¡Œç¨‹å…§å®¹
            const dayData = ITINERARY_DATA[day];
            const contentDiv = document.getElementById('day-content');
            
            if (!dayData) {
                contentDiv.innerHTML = '<p>è¡Œç¨‹è³‡æ–™è¼‰å…¥ä¸­...</p>';
                return;
            }

            let html = `
                <div class="day-header">
                    <h2>${dayData.title}</h2>
                    <p class="day-date">${dayData.date}</p>
                </div>
            `;

            // åŠ å…¥æ¯æ—¥å‹•ç·šé€£çµ
            if (dayData.mapUrl) {
                html += `
                    <div class="day-route-link">
                        <a href="${dayData.mapUrl}" target="_blank" rel="noopener noreferrer">
                            <i class="fas fa-map-marked-alt"></i>
                            æœ¬æ—¥Googleåœ°åœ–æ™¯é»å‹•ç·š - é»æ“ŠæŸ¥çœ‹å®Œæ•´è·¯ç·šè¦åŠƒ
                        </a>
                    </div>
                `;
            }

            dayData.items.forEach(item => {
                html += `
                    <div class="itinerary-item">
                        <h3>
                            <span class="time">${item.time}</span>
                            ${item.title}
                        </h3>
                        <p>${item.description}</p>
                        ${item.transport ? `
                            <div class="transport-info">
                                <h4><i class="fas fa-route"></i> äº¤é€šæ–¹å¼</h4>
                                <p><strong>æ–¹å¼ï¼š</strong>${item.transport.method}</p>
                                <p><strong>æ™‚é–“ï¼š</strong>${item.transport.duration}</p>
                                <p><strong>è²»ç”¨ï¼š</strong>${item.transport.cost}</p>
                                <p><strong>è·¯ç·šï¼š</strong>${item.transport.route}</p>
                            </div>
                        ` : ''}
                        ${item.food ? `
                            <div class="food-info">
                                <strong><i class="fas fa-utensils"></i> é¤é£²ï¼š</strong>${item.food}
                            </div>
                        ` : ''}
                        ${item.highlight ? `
                            <div class="highlight-info">
                                <strong><i class="fas fa-star"></i> æ™¯é»äº®é»ï¼š</strong>${item.highlight}
                            </div>
                        ` : ''}
                        ${item.mapUrl ? `
                            <div class="map-link">
                                <a href="${item.mapUrl}" target="_blank" rel="noopener noreferrer">
                                    <i class="fas fa-map-marker-alt"></i>
                                    åœ¨Googleåœ°åœ–ä¸­æŸ¥çœ‹ä½ç½®
                                </a>
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            contentDiv.innerHTML = html;
        }

        // è·¯ç·šæŸ¥è©¢åŠŸèƒ½
        function searchRoute() {
            const fromStation = document.getElementById('from-station').value.trim();
            const toStation = document.getElementById('to-station').value.trim();
            const resultDiv = document.getElementById('route-result');

            if (!fromStation || !toStation) {
                showAlert('è«‹è¼¸å…¥å‡ºç™¼ç«™å’Œç›®çš„åœ°', 'error');
                return;
            }

            showLoading(true);

            // æ¨¡æ“¬è·¯ç·šæŸ¥è©¢ (å¯¦éš›æ‡‰è©²å‘¼å« Google Apps Script API)
            setTimeout(() => {
                const mockResult = {
                    routes: [
                        {
                            method: "ğŸš‡ JRå±±æ‰‹ç·š",
                            duration: "ç´„15åˆ†é˜",
                            cost: "Â¥160",
                            transfers: 0,
                            route: `${fromStation} â†’ ${toStation}`
                        },
                        {
                            method: "ğŸš‡ æ±äº¬Metro + JR",
                            duration: "ç´„20åˆ†é˜",
                            cost: "Â¥200",
                            transfers: 1,
                            route: `${fromStation} â†’ è½‰ä¹˜ç«™ â†’ ${toStation}`
                        }
                    ]
                };

                let html = '<h3>æŸ¥è©¢çµæœ</h3>';
                mockResult.routes.forEach((route, index) => {
                    html += `
                        <div class="route-option" style="background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 3px solid #007bff;">
                            <h4>è·¯ç·š ${index + 1}</h4>
                            <p><strong>æ–¹å¼ï¼š</strong>${route.method}</p>
                            <p><strong>æ™‚é–“ï¼š</strong>${route.duration}</p>
                            <p><strong>è²»ç”¨ï¼š</strong>${route.cost}</p>
                            <p><strong>è½‰ä¹˜ï¼š</strong>${route.transfers}æ¬¡</p>
                            <p><strong>è·¯ç·šï¼š</strong>${route.route}</p>
                        </div>
                    `;
                });

                resultDiv.innerHTML = html;
                resultDiv.classList.remove('hidden');
                showLoading(false);
            }, 1500);
        }

        // è¼‰å…¥é ç®—è¨ˆç®—å™¨
        function loadBudgetCalculator() {
            calculateBudget();
        }

        // è¨ˆç®—é ç®—
        function calculateBudget() {
            const peopleCount = parseInt(document.getElementById('people-count').value) || 1;
            let totalAmount = 0;

            document.querySelectorAll('.expense-input').forEach(input => {
                const amount = parseInt(input.value) || 0;
                totalAmount += amount;
            });

            const perPersonAmount = Math.round(totalAmount / peopleCount);

            document.getElementById('total-amount').textContent = `Â¥${totalAmount.toLocaleString()}`;
            document.getElementById('per-person-amount').textContent = `Â¥${perPersonAmount.toLocaleString()}`;
        }

        // è¼‰å…¥å¾…è¾¦æ¸…å–®
        function loadChecklist() {
            // å¾ localStorage è¼‰å…¥æˆ–ä½¿ç”¨é è¨­è³‡æ–™
            const savedChecklist = localStorage.getItem('tokyo-checklist');
            checklistData = savedChecklist ? JSON.parse(savedChecklist) : DEFAULT_CHECKLIST;

            Object.keys(checklistData).forEach(category => {
                renderChecklistCategory(category);
            });
        }

        // æ¸²æŸ“å¾…è¾¦æ¸…å–®åˆ†é¡
        function renderChecklistCategory(category) {
            const container = document.getElementById(category);
            if (!container) return;

            let html = '';
            checklistData[category].forEach((item, index) => {
                const isCompleted = item.completed || false;
                const itemText = typeof item === 'string' ? item : item.text;
                
                html += `
                    <div class="checklist-item ${isCompleted ? 'completed' : ''}">
                        <input type="checkbox" ${isCompleted ? 'checked' : ''} 
                               onchange="toggleChecklistItem('${category}', ${index})">
                        <span>${itemText}</span>
                        <button class="delete-btn" onclick="deleteChecklistItem('${category}', ${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // æ–°å¢å¾…è¾¦äº‹é …
        function addChecklistItem() {
            const newItemInput = document.getElementById('new-item');
            const categorySelect = document.getElementById('item-category');
            const itemText = newItemInput.value.trim();
            const category = categorySelect.value;

            if (!itemText) {
                showAlert('è«‹è¼¸å…¥å¾…è¾¦äº‹é …å…§å®¹', 'error');
                return;
            }

            if (!checklistData[category]) {
                checklistData[category] = [];
            }

            checklistData[category].push({
                text: itemText,
                completed: false
            });

            // å„²å­˜åˆ° localStorage
            localStorage.setItem('tokyo-checklist', JSON.stringify(checklistData));

            // é‡æ–°æ¸²æŸ“è©²åˆ†é¡
            renderChecklistCategory(category);

            // æ¸…ç©ºè¼¸å…¥æ¡†
            newItemInput.value = '';
            
            showAlert('å¾…è¾¦äº‹é …å·²æ–°å¢', 'success');
        }

        // åˆ‡æ›å¾…è¾¦äº‹é …å®Œæˆç‹€æ…‹
        function toggleChecklistItem(category, index) {
            if (typeof checklistData[category][index] === 'string') {
                // è½‰æ›èˆŠæ ¼å¼ç‚ºæ–°æ ¼å¼
                checklistData[category][index] = {
                    text: checklistData[category][index],
                    completed: false
                };
            }

            checklistData[category][index].completed = !checklistData[category][index].completed;
            
            // å„²å­˜åˆ° localStorage
            localStorage.setItem('tokyo-checklist', JSON.stringify(checklistData));

            // é‡æ–°æ¸²æŸ“è©²åˆ†é¡
            renderChecklistCategory(category);
        }

        // åˆªé™¤å¾…è¾¦äº‹é …
        function deleteChecklistItem(category, index) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å¾…è¾¦äº‹é …å—ï¼Ÿ')) {
                checklistData[category].splice(index, 1);
                
                // å„²å­˜åˆ° localStorage
                localStorage.setItem('tokyo-checklist', JSON.stringify(checklistData));

                // é‡æ–°æ¸²æŸ“è©²åˆ†é¡
                renderChecklistCategory(category);
                
                showAlert('å¾…è¾¦äº‹é …å·²åˆªé™¤', 'success');
            }
        }

        // è¼‰å…¥æ—…éŠç­†è¨˜
        function loadNotes() {
            // å¾ localStorage è¼‰å…¥ç­†è¨˜
            const savedNotes = localStorage.getItem('tokyo-notes');
            notesData = savedNotes ? JSON.parse(savedNotes) : [];

            renderNotes();
        }

        // æ¸²æŸ“ç­†è¨˜åˆ—è¡¨
        function renderNotes() {
            const notesContainer = document.getElementById('notes-list');
            
            if (notesData.length === 0) {
                notesContainer.innerHTML = '<p style="text-align: center; color: #6c757d; padding: 20px;">å°šç„¡æ—…éŠç­†è¨˜ï¼Œé–‹å§‹è¨˜éŒ„ä½ çš„æ±äº¬ä¹‹æ—…å§ï¼</p>';
                return;
            }

            let html = '';
            notesData.forEach((note, index) => {
                html += `
                    <div class="note-item">
                        <h4>${note.title}</h4>
                        <div class="note-date">
                            <i class="fas fa-calendar"></i> ${note.date}
                        </div>
                        <div class="note-content">${note.content.replace(/\n/g, '<br>')}</div>
                        <div class="note-actions">
                            <button class="delete-note-btn" onclick="deleteNote(${index})">
                                <i class="fas fa-trash"></i> åˆªé™¤ </button>
                        </div>
                    </div>
                `;
            });

            notesContainer.innerHTML = html;
        }

        // å„²å­˜ç­†è¨˜
        function saveNote() {
            const titleInput = document.getElementById('note-title');
            const contentInput = document.getElementById('note-content');
            
            const title = titleInput.value.trim();
            const content = contentInput.value.trim();

            if (!title || !content) {
                showAlert('è«‹è¼¸å…¥ç­†è¨˜æ¨™é¡Œå’Œå…§å®¹', 'error');
                return;
            }

            const newNote = {
                title: title,
                content: content,
                date: new Date().toLocaleString('zh-TW'),
                id: Date.now()
            };

            notesData.unshift(newNote); // æ–°ç­†è¨˜æ”¾åœ¨æœ€å‰é¢

            // å„²å­˜åˆ° localStorage
            localStorage.setItem('tokyo-notes', JSON.stringify(notesData));

            // æ¸…ç©ºè¼¸å…¥æ¡†
            titleInput.value = '';
            contentInput.value = '';

            // é‡æ–°æ¸²æŸ“ç­†è¨˜åˆ—è¡¨
            renderNotes();

            showAlert('ç­†è¨˜å·²å„²å­˜', 'success');
        }

        // åˆªé™¤ç­†è¨˜
        function deleteNote(index) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å‰‡ç­†è¨˜å—ï¼Ÿ')) {
                notesData.splice(index, 1);
                
                // å„²å­˜åˆ° localStorage
                localStorage.setItem('tokyo-notes', JSON.stringify(notesData));

                // é‡æ–°æ¸²æŸ“ç­†è¨˜åˆ—è¡¨
                renderNotes();
                
                showAlert('ç­†è¨˜å·²åˆªé™¤', 'success');
            }
        }

        // åˆ†äº«è¡Œç¨‹åŠŸèƒ½
        function shareItinerary() {
            if (navigator.share) {
                // ä½¿ç”¨åŸç”Ÿåˆ†äº« API
                navigator.share({
                    title: 'æ±äº¬äº”æ—¥éŠè¡Œç¨‹',
                    text: 'æˆ‘çš„æ±äº¬æ—…éŠè¡Œç¨‹è¦åŠƒï¼Œä¸€èµ·ä¾†çœ‹çœ‹å§ï¼',
                    url: window.location.href
                }).then(() => {
                    showAlert('åˆ†äº«æˆåŠŸ', 'success');
                }).catch((error) => {
                    console.log('åˆ†äº«å¤±æ•—:', error);
                    fallbackShare();
                });
            } else {
                // å‚™ç”¨åˆ†äº«æ–¹å¼
                fallbackShare();
            }
        }

        // å‚™ç”¨åˆ†äº«æ–¹å¼
        function fallbackShare() {
            const url = window.location.href;
            const text = `æ±äº¬äº”æ—¥éŠè¡Œç¨‹ - ${url}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showAlert('é€£çµå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿', 'success');
                });
            } else {
                // å‰µå»ºè‡¨æ™‚æ–‡å­—å€åŸŸ
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showAlert('é€£çµå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿', 'success');
            }
        }

        // é›¢ç·šä¸‹è¼‰åŠŸèƒ½
        function downloadOffline() {
            showLoading(true);

            // æº–å‚™é›¢ç·šè³‡æ–™
            const offlineData = {
                itinerary: ITINERARY_DATA,
                checklist: checklistData,
                notes: notesData,
                exportDate: new Date().toLocaleString('zh-TW')
            };

            // å‰µå»º JSON æª”æ¡ˆ
            const dataStr = JSON.stringify(offlineData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            // å‰µå»ºä¸‹è¼‰é€£çµ
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(dataBlob);
            downloadLink.download = `æ±äº¬æ—…éŠè¡Œç¨‹_${new Date().toISOString().split('T')[0]}.json`;
            
            // è§¸ç™¼ä¸‹è¼‰
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            
            setTimeout(() => {
                showLoading(false);
                showAlert('è¡Œç¨‹è³‡æ–™å·²ä¸‹è¼‰', 'success');
            }, 1000);
        }

        // é¡¯ç¤ºè¼‰å…¥å‹•ç•«
        function showLoading(show) {
            const loadingDiv = document.getElementById('loading');
            if (show) {
                loadingDiv.classList.remove('hidden');
            } else {
                loadingDiv.classList.add('hidden');
            }
        }

        // é¡¯ç¤ºæç¤ºè¨Šæ¯
        function showAlert(message, type = 'success') {
            // ç§»é™¤ç¾æœ‰çš„æç¤ºè¨Šæ¯
            const existingAlert = document.querySelector('.alert');
            if (existingAlert) {
                existingAlert.remove();
            }

            // å‰µå»ºæ–°çš„æç¤ºè¨Šæ¯
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
                ${message}
            `;

            // æ’å…¥åˆ°ä¸»è¦å…§å®¹å€åŸŸçš„é ‚éƒ¨
            const mainContent = document.querySelector('.main-content');
            mainContent.insertBefore(alertDiv, mainContent.firstChild);

            // 3ç§’å¾Œè‡ªå‹•ç§»é™¤
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 3000);
        }

        // Google Apps Script API å‘¼å«å‡½æ•¸
        async function callGASAPI(action, data = {}) {
            try {
                const response = await fetch(API_BASE_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: action,
                        data: data
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('API å‘¼å«å¤±æ•—:', error);
                showAlert('ç¶²è·¯é€£ç·šå¤±æ•—ï¼Œä½¿ç”¨é›¢ç·šæ¨¡å¼', 'error');
                return null;
            }
        }

        // å„²å­˜è³‡æ–™åˆ° Google Sheets (å¯é¸åŠŸèƒ½)
        async function saveToCloud() {
            const cloudData = {
                checklist: checklistData,
                notes: notesData,
                lastUpdate: new Date().toISOString()
            };

            const result = await callGASAPI('saveData', cloudData);
            
            if (result && result.success) {
                showAlert('è³‡æ–™å·²åŒæ­¥åˆ°é›²ç«¯', 'success');
            } else {
                showAlert('é›²ç«¯åŒæ­¥å¤±æ•—ï¼Œè³‡æ–™å·²å„²å­˜åœ¨æœ¬æ©Ÿ', 'error');
            }
        }

        // å¾é›²ç«¯è¼‰å…¥è³‡æ–™ (å¯é¸åŠŸèƒ½)
        async function loadFromCloud() {
            showLoading(true);
            
            const result = await callGASAPI('loadData');
            
            if (result && result.success && result.data) {
                checklistData = result.data.checklist || checklistData;
                notesData = result.data.notes || notesData;
                
                // æ›´æ–° localStorage
                localStorage.setItem('tokyo-checklist', JSON.stringify(checklistData));
                localStorage.setItem('tokyo-notes', JSON.stringify(notesData));
                
                // é‡æ–°æ¸²æŸ“
                loadChecklist();
                renderNotes();
                
                showAlert('é›²ç«¯è³‡æ–™è¼‰å…¥æˆåŠŸ', 'success');
            }
            
            showLoading(false);
        }

        // éµç›¤å¿«æ·éµ
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + S å„²å­˜ç­†è¨˜
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.id === 'notes') {
                    saveNote();
                }
            }
            
            // Ctrl/Cmd + Enter æ–°å¢å¾…è¾¦äº‹é …
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.id === 'checklist') {
                    addChecklistItem();
                }
            }
            
            // æ•¸å­—éµ 1-5 åˆ‡æ›è¡Œç¨‹æ—¥æœŸ
            if (e.key >= '1' && e.key <= '5') {
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.id === 'itinerary') {
                    const day = parseInt(e.key);
                    loadItinerary(day);
                }
            }
        });

        // PWA æ”¯æ´ (Service Worker)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // è‡ªå‹•å„²å­˜åŠŸèƒ½
        setInterval(function() {
            // æ¯30ç§’è‡ªå‹•å„²å­˜åˆ° localStorage
            localStorage.setItem('tokyo-checklist', JSON.stringify(checklistData));
            localStorage.setItem('tokyo-notes', JSON.stringify(notesData));
        }, 30000);

        // é é¢å¯è¦‹æ€§è®ŠåŒ–æ™‚å„²å­˜è³‡æ–™
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                localStorage.setItem('tokyo-checklist', JSON.stringify(checklistData));
                localStorage.setItem('tokyo-notes', JSON.stringify(notesData));
            }
        });

        // è§¸æ§æ‰‹å‹¢æ”¯æ´ (è¡Œå‹•è£ç½®)
        let touchStartX = 0;
        let touchStartY = 0;

        document.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });

        document.addEventListener('touchend', function(e) {
            if (!touchStartX || !touchStartY) return;

            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;

            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;

            // åˆ¤æ–·æ˜¯å¦ç‚ºæ°´å¹³æ»‘å‹•
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.id === 'itinerary') {
                    if (diffX > 0 && currentDay < 5) {
                        // å‘å·¦æ»‘å‹•ï¼Œä¸‹ä¸€å¤©
                        loadItinerary(currentDay + 1);
                    } else if (diffX < 0 && currentDay > 1) {
                        // å‘å³æ»‘å‹•ï¼Œä¸Šä¸€å¤©
                        loadItinerary(currentDay - 1);
                    }
                }
            }

            touchStartX = 0;
            touchStartY = 0;
        });

        // æ·±è‰²æ¨¡å¼åˆ‡æ›
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('dark-mode', document.body.classList.contains('dark-mode'));
        }

        // è¼‰å…¥æ·±è‰²æ¨¡å¼è¨­å®š
        if (localStorage.getItem('dark-mode') === 'true') {
            document.body.classList.add('dark-mode');
        }

        // åŒ¯å‡ºåŠŸèƒ½å¢å¼·
        function exportToPDF() {
            showAlert('PDF åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­...', 'error');
            // é€™è£¡å¯ä»¥æ•´åˆ jsPDF æˆ–å…¶ä»– PDF ç”Ÿæˆåº«
        }

        // èªéŸ³å‚™å¿˜éŒ„åŠŸèƒ½ (å¯¦é©—æ€§)
        function startVoiceMemo() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'zh-TW';

                recognition.start();

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('note-content').value += transcript;
                    showAlert('èªéŸ³è­˜åˆ¥å®Œæˆ', 'success');
                };

                recognition.onerror = function(event) {
                    showAlert('èªéŸ³è­˜åˆ¥å¤±æ•—', 'error');
                };
            } else {
                showAlert('ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è­˜åˆ¥', 'error');
            }
        }

        // å¤©æ°£è³‡è¨Š (å¯é¸åŠŸèƒ½)
        async function getWeatherInfo() {
            // é€™è£¡å¯ä»¥æ•´åˆå¤©æ°£ API
            showAlert('å¤©æ°£è³‡è¨ŠåŠŸèƒ½é–‹ç™¼ä¸­...', 'error');
        }

        // åŒ¯ç‡è½‰æ›åŠŸèƒ½
        function convertCurrency(amount, fromCurrency = 'JPY', toCurrency = 'TWD') {
            // æ¨¡æ“¬åŒ¯ç‡ (å¯¦éš›æ‡‰è©²å‘¼å«åŒ¯ç‡ API)
            const exchangeRates = {
                'JPY_TWD': 0.21,
                'TWD_JPY': 4.76
            };

            const rate = exchangeRates[`${fromCurrency}_${toCurrency}`];
            return rate ? (amount * rate).toFixed(0) : amount;
        }

        // æ–°å¢åŒ¯ç‡é¡¯ç¤ºåˆ°é ç®—è¨ˆç®—å™¨
        function updateBudgetWithExchangeRate() {
            const totalJPY = parseInt(document.getElementById('total-amount').textContent.replace(/[Â¥,]/g, ''));
            const totalTWD = convertCurrency(totalJPY, 'JPY', 'TWD');
            
            // åœ¨é ç®—æ‘˜è¦ä¸­é¡¯ç¤ºå°å¹£é‡‘é¡
            const summaryDiv = document.querySelector('.budget-summary');
            let twdDisplay = summaryDiv.querySelector('.twd-amount');
            
            if (!twdDisplay) {
                twdDisplay = document.createElement('p');
                twdDisplay.className = 'twd-amount';
                summaryDiv.appendChild(twdDisplay);
            }
            
            twdDisplay.innerHTML = `ç´„ NT$${parseInt(totalTWD).toLocaleString()}`;
        }

        // ä¿®æ”¹é ç®—è¨ˆç®—å‡½æ•¸ä»¥åŒ…å«åŒ¯ç‡
        const originalCalculateBudget = calculateBudget;
        calculateBudget = function() {
            originalCalculateBudget();
            updateBudgetWithExchangeRate();
        };

        // åˆå§‹åŒ–å®Œæˆæç¤º
        console.log('ğŸ—¾ æ±äº¬æ—…éŠè¡Œç¨‹ App å·²è¼‰å…¥å®Œæˆï¼');
        console.log('ğŸ’¡ å°æç¤ºï¼š');
        console.log('   - ä½¿ç”¨æ•¸å­—éµ 1-5 å¿«é€Ÿåˆ‡æ›è¡Œç¨‹æ—¥æœŸ');
        console.log('   - Ctrl+S å¿«é€Ÿå„²å­˜ç­†è¨˜');
        console.log('   - Ctrl+Enter å¿«é€Ÿæ–°å¢å¾…è¾¦äº‹é …');
        console.log('   - åœ¨è¡Œç¨‹é é¢å·¦å³æ»‘å‹•å¯åˆ‡æ›æ—¥æœŸ (è¡Œå‹•è£ç½®)');
        console.log('   - é»æ“Šåœ°åœ–é€£çµå¯åœ¨Googleåœ°åœ–ä¸­æŸ¥çœ‹è©³ç´°ä½ç½®');
    </script>
</body>
</html>

                            


